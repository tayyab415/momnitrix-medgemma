{
  "version": 3,
  "sources": ["src/domain/constants.ts", "src/domain/validation.ts", "src/domain/randomizer.ts", "src/domain/payload.ts", "src/domain/sse.ts", "src/adapters/audio.ts", "src/adapters/base64.ts", "src/adapters/media.ts", "src/adapters/streaming.ts", "src/domain/formatters.ts", "src/ui/dom.ts", "src/main.ts"],
  "sourcesContent": ["/**\n * Momnitrix QA Console \u2013 Centralized Constants\n *\n * Single source of truth for all hardcoded IDs, labels, ranges, and\n * configuration values.  No duplicated literals across files.\n */\n\nimport type {\n    RequiredRule,\n    OptionalNumericRule,\n    ProfileMode,\n    Modality,\n} from './types';\n\n// ---------------------------------------------------------------------------\n// Required vitals rules (gate the Diagnose button)\n// ---------------------------------------------------------------------------\n\nexport const REQUIRED_RULES: readonly RequiredRule[] = [\n    { id: 'age', label: 'Age', min: 13, max: 50 },\n    { id: 'systolicBp', label: 'Systolic BP', min: 80, max: 180 },\n    { id: 'diastolicBp', label: 'Diastolic BP', min: 45, max: 120 },\n    { id: 'fastingGlucose', label: 'Fasting glucose', min: 3.0, max: 20.0 },\n    { id: 'tempF', label: 'Body temperature (degF)', min: 95, max: 104 },\n    { id: 'restingHr', label: 'Resting heart rate', min: 45, max: 140 },\n] as const;\n\n// ---------------------------------------------------------------------------\n// Optional numeric rules\n// ---------------------------------------------------------------------------\n\nexport const OPTIONAL_NUMERIC_RULES: readonly OptionalNumericRule[] = [\n    { id: 'gestWeeks', label: 'Gestational weeks', min: 4, max: 42 },\n    { id: 'gravidity', label: 'Gravidity', min: 1, max: 10 },\n    { id: 'parity', label: 'Parity', min: 0, max: 10 },\n    { id: 'spo2', label: 'SpO2', min: 88, max: 100 },\n    { id: 'hrv', label: 'HRV', min: 10, max: 140 },\n] as const;\n\n// ---------------------------------------------------------------------------\n// SSE event labels\n// ---------------------------------------------------------------------------\n\nexport const EVENT_LABELS: Readonly<Record<string, string>> = {\n    'request.accepted': 'Request Accepted',\n    'request.rejected': 'Request Rejected',\n    'router.decision': 'Router Decision',\n    'router.prompt_plan': 'Prompt Plan',\n    'model.started': 'Specialist Started',\n    'model.completed': 'Specialist Completed',\n    'model.failed': 'Specialist Failed',\n    'medgemma.started': 'MedGemma Started',\n    'medgemma.completed': 'MedGemma Completed',\n    'medgemma.delta': 'MedGemma Stream Chunk',\n    'gemini.started': 'Gemini Started',\n    'gemini.completed': 'Gemini Completed',\n    'gemini.skipped': 'Gemini Skipped',\n    'diagnostics.inference_breakdown': 'Inference Diagnostics',\n    'triage.final': 'Final Response',\n    'triage.error': 'Pipeline Error',\n};\n\n// ---------------------------------------------------------------------------\n// Modalities\n// ---------------------------------------------------------------------------\n\nexport const MODALITIES: readonly Modality[] = ['text', 'voice', 'image'];\n\n// ---------------------------------------------------------------------------\n// Result card ordering (matches HTML data-card attributes)\n// ---------------------------------------------------------------------------\n\nexport const RESULT_CARD_ORDER: readonly string[] = [\n    'overview',\n    'patient_guidance',\n    'visit_summary',\n    'specialist_signals',\n    'clinical_reasons',\n    'action_plan',\n    'raw_json',\n];\n\n// ---------------------------------------------------------------------------\n// Default form field values (used by resetToDefaults)\n// ---------------------------------------------------------------------------\n\nexport const DEFAULT_FORM_VALUES = {\n    requestId: '',\n    randomProfileMode: 'none yet',\n    age: '25',\n    gestWeeks: '31',\n    gravidity: '2',\n    parity: '1',\n    bmiGroup: 'overweight',\n    knownConditions: '',\n    medications: 'prenatal_vitamins',\n    systolicBp: '130',\n    diastolicBp: '80',\n    fastingGlucose: '5.1',\n    tempF: '98.0',\n    restingHr: '86',\n    spo2: '98',\n    hrv: '42.0',\n    headache: false,\n    visionChanges: false,\n    decreasedFetalMovement: false,\n    freeText: '',\n} as const;\n\n// ---------------------------------------------------------------------------\n// Profile modes for clinical randomization\n// ---------------------------------------------------------------------------\n\nexport const PROFILE_MODES: readonly ProfileMode[] = [\n    {\n        name: 'normal_monitoring',\n        weight: 0.5,\n        valueRanges: {\n            age: [20, 34],\n            gestWeeks: [20, 39],\n            gravidity: [1, 4],\n            parity: [0, 3],\n            systolicBp: [104, 126],\n            diastolicBp: [64, 82],\n            fastingGlucose: [4.0, 5.2],\n            tempF: [97.3, 99.0],\n            restingHr: [62, 92],\n            spo2: [96, 100],\n            hrv: [28, 95],\n        },\n        bmiGroup: ['normal', 'overweight'],\n        knownConditions: ['none'],\n        medications: ['prenatal_vitamins'],\n        booleans: {\n            headache: 0.08,\n            visionChanges: 0.04,\n            decreasedFetalMovement: 0.05,\n        },\n        notes: [\n            'Routine evening check-in, feeling mostly stable.',\n            'No major concerns today, just regular tracking update.',\n        ],\n    },\n    {\n        name: 'borderline_risk',\n        weight: 0.34,\n        valueRanges: {\n            age: [24, 40],\n            gestWeeks: [26, 40],\n            gravidity: [2, 6],\n            parity: [1, 4],\n            systolicBp: [128, 146],\n            diastolicBp: [80, 94],\n            fastingGlucose: [5.3, 7.8],\n            tempF: [97.6, 99.7],\n            restingHr: [76, 104],\n            spo2: [94, 99],\n            hrv: [18, 70],\n        },\n        bmiGroup: ['overweight', 'obese'],\n        knownConditions: ['prior_gdm', 'chronic_hypertension', 'none'],\n        medications: ['prenatal_vitamins', 'low_dose_aspirin', 'none'],\n        booleans: {\n            headache: 0.35,\n            visionChanges: 0.12,\n            decreasedFetalMovement: 0.16,\n        },\n        notes: [\n            'Mild headache intermittently, requested triage review.',\n            'Monitoring trend change over last 2 days.',\n        ],\n    },\n    {\n        name: 'red_flag',\n        weight: 0.16,\n        valueRanges: {\n            age: [19, 43],\n            gestWeeks: [28, 41],\n            gravidity: [2, 8],\n            parity: [1, 5],\n            systolicBp: [150, 170],\n            diastolicBp: [95, 112],\n            fastingGlucose: [8.5, 16.0],\n            tempF: [98.0, 101.5],\n            restingHr: [88, 125],\n            spo2: [92, 98],\n            hrv: [10, 55],\n        },\n        bmiGroup: ['overweight', 'obese'],\n        knownConditions: [\n            'gestational_diabetes',\n            'chronic_hypertension',\n            'prior_preeclampsia',\n        ],\n        medications: ['insulin', 'labetalol', 'prenatal_vitamins'],\n        booleans: {\n            headache: 0.62,\n            visionChanges: 0.4,\n            decreasedFetalMovement: 0.28,\n        },\n        notes: [\n            'Symptoms feel worse than baseline, requesting urgent review.',\n            'Persistent headache and elevated values, worried about progression.',\n        ],\n    },\n];\n\n// ---------------------------------------------------------------------------\n// Metadata constants sent in payload\n// ---------------------------------------------------------------------------\n\nexport const PAYLOAD_SOURCE = 'qa_console_watch_prototype';\nexport const COMPOSER_MODE = 'medgemma_first';\nexport const OUTPUT_STYLE = 'notebook';\nexport const TEMP_INPUT_UNIT = 'degF';\n\n// ---------------------------------------------------------------------------\n// Audio MIME candidates for MediaRecorder (preference order)\n// ---------------------------------------------------------------------------\n\nexport const AUDIO_MIME_CANDIDATES: readonly string[] = [\n    'audio/webm;codecs=opus',\n    'audio/webm',\n    'audio/ogg;codecs=opus',\n    'audio/mp4',\n];\n", "/**\n * Momnitrix QA Console \u2013 Pure Validation Logic\n *\n * No DOM access.  Accepts extracted values and returns structured results.\n */\n\nimport type {\n    ValidationResult,\n    RequiredRule,\n    OptionalNumericRule,\n    RequiredValuesMap,\n    OptionalValuesMap,\n    Modality,\n} from './types';\nimport { REQUIRED_RULES, OPTIONAL_NUMERIC_RULES } from './constants';\n\n/**\n * Evaluate required vitals fields.\n *\n * @param values \u2013 a map from rule.id to the numeric value (or null if\n *   missing/invalid).\n * @param rules  \u2013 override for testing; defaults to REQUIRED_RULES.\n * @returns missing labels and validation error messages.\n */\nexport function evaluateRequiredInputs(\n    values: RequiredValuesMap,\n    rules: readonly RequiredRule[] = REQUIRED_RULES,\n): ValidationResult {\n    const missing: string[] = [];\n    const errors: string[] = [];\n\n    for (const rule of rules) {\n        const value = values[rule.id] ?? null;\n        if (value === null) {\n            missing.push(rule.label);\n            continue;\n        }\n        if (value < rule.min || value > rule.max) {\n            errors.push(`${rule.label} must be between ${rule.min} and ${rule.max}.`);\n        }\n    }\n\n    const systolic = values['systolicBp'] ?? null;\n    const diastolic = values['diastolicBp'] ?? null;\n    if (systolic !== null && diastolic !== null && systolic <= diastolic) {\n        errors.push('Systolic BP must be greater than diastolic BP.');\n    }\n\n    return { missing, errors };\n}\n\n/**\n * Full input validation (required + optional + backend URL + mode checks).\n *\n * @returns array of human-readable error strings.  Empty = valid.\n */\nexport function validateAllInputs(\n    requiredValues: RequiredValuesMap,\n    optionalValues: OptionalValuesMap,\n    backendUrl: string,\n    activeMode: Modality,\n    hasAudio: boolean,\n    requiredRules: readonly RequiredRule[] = REQUIRED_RULES,\n    optionalRules: readonly OptionalNumericRule[] = OPTIONAL_NUMERIC_RULES,\n): string[] {\n    const errors: string[] = [];\n\n    const required = evaluateRequiredInputs(requiredValues, requiredRules);\n    errors.push(...required.errors);\n    if (required.missing.length > 0) {\n        errors.push(`Missing required inputs: ${required.missing.join(', ')}.`);\n    }\n\n    for (const rule of optionalRules) {\n        const raw = (optionalValues[rule.id] ?? '').trim();\n        if (!raw) continue;\n        const value = Number(raw);\n        if (Number.isNaN(value)) {\n            errors.push(`${rule.label} must be a valid number.`);\n            continue;\n        }\n        if (value < rule.min || value > rule.max) {\n            errors.push(`${rule.label} must be between ${rule.min} and ${rule.max}.`);\n        }\n    }\n\n    if (!backendUrl.startsWith('http://') && !backendUrl.startsWith('https://')) {\n        errors.push('Backend URL must start with http:// or https://');\n    }\n\n    if (activeMode === 'voice' && !hasAudio) {\n        errors.push(\n            'Voice mode selected but no audio attached. Upload audio or record in-app.',\n        );\n    }\n\n    return errors;\n}\n\n/**\n * Parse a raw string value from an input field to a number or null.\n */\nexport function parseNumericInput(raw: string): number | null {\n    const trimmed = raw.trim();\n    if (!trimmed) return null;\n    const value = Number(trimmed);\n    return Number.isNaN(value) ? null : value;\n}\n", "/**\n * Momnitrix QA Console \u2013 Clinical Profile Randomizer\n *\n * All randomisation is injectable via an RNG function for deterministic\n * testing.  No DOM access.\n */\n\nimport type {\n    ProfileMode,\n    RandomProfileResult,\n    RngFunction,\n} from './types';\nimport { PROFILE_MODES } from './constants';\n\n// ---------------------------------------------------------------------------\n// Primitive helpers\n// ---------------------------------------------------------------------------\n\n/**\n * Random integer in [min, max] (inclusive).\n */\nexport function randomInt(\n    min: number,\n    max: number,\n    rng: RngFunction = Math.random,\n): number {\n    return Math.floor(rng() * (max - min + 1)) + min;\n}\n\n/**\n * Random float in [min, max] with given step, rounded to 2 decimal places.\n */\nexport function randomFloat(\n    min: number,\n    max: number,\n    step = 0.1,\n    rng: RngFunction = Math.random,\n): number {\n    const span = Math.round((max - min) / step);\n    const pick = randomInt(0, span, rng);\n    return Number((min + pick * step).toFixed(2));\n}\n\n/**\n * Weighted random selection from an array of items with `.weight`.\n */\nexport function weightedPick<T extends { weight: number }>(\n    options: readonly T[],\n    rng: RngFunction = Math.random,\n): T {\n    const total = options.reduce((sum, item) => sum + item.weight, 0);\n    let marker = rng() * total;\n    for (const item of options) {\n        marker -= item.weight;\n        if (marker <= 0) return item;\n    }\n    return options[options.length - 1];\n}\n\n/**\n * Uniformly pick one element from an array.\n */\nexport function pick<T>(\n    values: readonly T[],\n    rng: RngFunction = Math.random,\n): T {\n    return values[randomInt(0, values.length - 1, rng)];\n}\n\n// ---------------------------------------------------------------------------\n// Profile generation\n// ---------------------------------------------------------------------------\n\n/**\n * Generate a complete random patient profile using weighted profile modes.\n *\n * Returns a pure-data object (no DOM references).  The caller (UI layer)\n * is responsible for applying the values to form fields.\n */\nexport function generateRandomProfile(\n    rng: RngFunction = Math.random,\n    modes: readonly ProfileMode[] = PROFILE_MODES,\n): RandomProfileResult {\n    const mode = weightedPick(modes, rng);\n    const r = mode.valueRanges;\n\n    const age = randomInt(r.age[0], r.age[1], rng);\n    const gestWeeks = randomInt(r.gestWeeks[0], r.gestWeeks[1], rng);\n    const gravidity = randomInt(r.gravidity[0], r.gravidity[1], rng);\n    const parityCandidate = randomInt(r.parity[0], r.parity[1], rng);\n    const parity = Math.min(parityCandidate, gravidity);\n\n    let systolicBp = randomInt(r.systolicBp[0], r.systolicBp[1], rng);\n    let diastolicBp = randomInt(r.diastolicBp[0], r.diastolicBp[1], rng);\n    if (diastolicBp >= systolicBp) {\n        diastolicBp = systolicBp - randomInt(8, 25, rng);\n    }\n\n    const fastingGlucose = randomFloat(\n        r.fastingGlucose[0],\n        r.fastingGlucose[1],\n        0.1,\n        rng,\n    );\n    const tempF = randomFloat(r.tempF[0], r.tempF[1], 0.1, rng);\n    const restingHr = randomInt(r.restingHr[0], r.restingHr[1], rng);\n    const spo2 = randomInt(r.spo2[0], r.spo2[1], rng);\n    const hrv = randomFloat(r.hrv[0], r.hrv[1], 0.1, rng);\n\n    const headache = rng() < mode.booleans.headache;\n    const visionChanges = rng() < mode.booleans.visionChanges;\n    const decreasedFetalMovement = rng() < mode.booleans.decreasedFetalMovement;\n\n    const bmiGroup = pick(mode.bmiGroup, rng);\n    const selectedCondition = pick(mode.knownConditions, rng);\n    const selectedMedication = pick(mode.medications, rng);\n    const freeText = pick(mode.notes, rng);\n\n    return {\n        age,\n        gestWeeks,\n        gravidity,\n        parity,\n        bmiGroup,\n        systolicBp,\n        diastolicBp,\n        fastingGlucose,\n        tempF,\n        restingHr,\n        spo2,\n        hrv,\n        headache,\n        visionChanges,\n        decreasedFetalMovement,\n        knownConditions: selectedCondition === 'none' ? '' : selectedCondition,\n        medications: selectedMedication === 'none' ? '' : selectedMedication,\n        freeText,\n        profileModeName: mode.name,\n    };\n}\n", "/**\n * Momnitrix QA Console \u2013 Payload Composition\n *\n * Pure functions to build the TriageRequest payload.  No DOM access.\n */\n\nimport type {\n    TriageRequest,\n    FormValues,\n    Modality,\n} from './types';\nimport {\n    PAYLOAD_SOURCE,\n    COMPOSER_MODE,\n    OUTPUT_STYLE,\n    TEMP_INPUT_UNIT,\n} from './constants';\nimport { randomInt } from './randomizer';\n\n/**\n * Convert a comma-separated string to a trimmed, non-empty list.\n */\nexport function parseCsvList(value: string): string[] {\n    return String(value || '')\n        .split(',')\n        .map((x) => x.trim())\n        .filter(Boolean);\n}\n\n/**\n * Convert Fahrenheit to Celsius, rounded to 2 decimal places.\n */\nexport function celsiusFromFahrenheit(tempF: number): number {\n    return Number((((tempF - 32) * 5) / 9).toFixed(2));\n}\n\n/**\n * Build the patient profile summary string for the free-text note.\n */\nexport function composeProfileSummary(\n    age: number,\n    gravidity: number,\n    parity: number,\n    gestWeeks: number,\n    bmiGroup: string,\n): string {\n    return [\n        'Patient profile:',\n        `- Age: ${age} years`,\n        `- Obstetric history: G${gravidity}P${parity}`,\n        `- Gestational age: ${gestWeeks} weeks`,\n        `- BMI group: ${bmiGroup}`,\n    ].join('\\n');\n}\n\n/**\n * Build the full TriageRequest payload from form values.\n *\n * @param values     \u2013 all extracted form field values\n * @param activeMode \u2013 currently selected modality\n * @returns a TriageRequest ready for JSON serialisation\n */\nexport function composePayloadSkeleton(\n    values: FormValues,\n    activeMode: Modality,\n): TriageRequest {\n    const knownConditions = parseCsvList(values.knownConditions).filter(\n        (x) => x.toLowerCase() !== 'none',\n    );\n    const medications = parseCsvList(values.medications).filter(\n        (x) => x.toLowerCase() !== 'none',\n    );\n    const note = (values.freeText || '').trim();\n    const age = values.age ?? 0;\n    const gravidity = values.gravidity ?? 0;\n    const parity = values.parity ?? 0;\n    const gestWeeks = values.gestWeeks ?? 0;\n    const bmiGroup = values.bmiGroup || 'normal';\n\n    const profileSummary = composeProfileSummary(\n        age,\n        gravidity,\n        parity,\n        gestWeeks,\n        bmiGroup,\n    );\n    const tempF = values.tempF ?? 98;\n    const requestId =\n        (values.requestId || '').trim() ||\n        `qa-${Date.now()}-${randomInt(100, 999)}`;\n\n    const noteParts = [profileSummary];\n    if (note) {\n        noteParts.push(`Clinical note:\\n${note}`);\n    } else if (activeMode === 'voice') {\n        noteParts.push(\n            'Voice-first check-in. Prioritize transcript content from MedASR.',\n        );\n    } else if (activeMode === 'image') {\n        noteParts.push(\n            'Image-first check-in. Combine specialist image outputs with vitals.',\n        );\n    }\n\n    return {\n        request_id: requestId,\n        patient_context: {\n            age_years: age,\n            gestational_weeks: gestWeeks,\n            known_conditions: knownConditions,\n            medications: medications,\n        },\n        vitals: {\n            systolic_bp: values.systolicBp ?? 0,\n            diastolic_bp: values.diastolicBp ?? 0,\n            fasting_glucose: values.fastingGlucose ?? 0,\n            hr: values.restingHr ?? 0,\n            spo2: values.spo2 ?? 0,\n            temp_c: celsiusFromFahrenheit(tempF),\n            hrv: values.hrv ?? 0,\n        },\n        inputs: {\n            headache: values.headache,\n            vision_changes: values.visionChanges,\n            decreased_fetal_movement: values.decreasedFetalMovement,\n            free_text: noteParts.join('\\n\\n'),\n            wound_image_b64: null,\n            skin_image_b64: null,\n            audio_b64: null,\n        },\n        metadata: {\n            source: PAYLOAD_SOURCE,\n            composer_mode: COMPOSER_MODE,\n            medgemma_output_style: OUTPUT_STYLE,\n            ui_mode: activeMode,\n            simulator: {\n                age_years: age,\n                bmi_group: bmiGroup,\n                gravidity: gravidity,\n                parity: parity,\n                temp_input_unit: TEMP_INPUT_UNIT,\n            },\n        },\n    };\n}\n", "/**\n * Momnitrix QA Console \u2013 SSE Stream Parser\n *\n * Pure functions for server-sent events parsing.  No DOM access.\n */\n\n/**\n * Callback invoked for each parsed SSE event.\n */\nexport type SseEventHandler = (\n    eventName: string,\n    payload: Record<string, unknown>,\n) => void;\n\n/**\n * Parse a single SSE text block (between double-newlines) and invoke the\n * handler with the parsed event name and payload.\n */\nexport function parseBlock(block: string, onEvent: SseEventHandler): void {\n    const lines = block.split('\\n');\n    let eventName = 'message';\n    const dataLines: string[] = [];\n\n    for (const line of lines) {\n        if (!line || line.startsWith(':')) continue;\n        if (line.startsWith('event:')) {\n            eventName = line.slice(6).trim();\n            continue;\n        }\n        if (line.startsWith('data:')) {\n            dataLines.push(line.slice(5).trim());\n        }\n    }\n\n    const dataRaw = dataLines.join('\\n');\n    let payload: Record<string, unknown> = { raw: dataRaw };\n    if (dataRaw) {\n        try {\n            payload = JSON.parse(dataRaw) as Record<string, unknown>;\n        } catch {\n            payload = { raw: dataRaw };\n        }\n    }\n    onEvent(eventName, payload);\n}\n\n/**\n * Create a stateful SSE parser that buffers incoming text chunks and emits\n * complete events via `onEvent`.\n *\n * @returns A function accepting `(chunk: string, flush?: boolean)`.\n *   Call with `flush = true` after the stream ends to emit any remaining\n *   buffered data.\n */\nexport function createSseEventParser(\n    onEvent: SseEventHandler,\n): (chunk: string, flush?: boolean) => void {\n    let buffer = '';\n\n    return (chunk: string, flush = false): void => {\n        buffer += chunk.replace(/\\r/g, '');\n        while (true) {\n            const splitAt = buffer.indexOf('\\n\\n');\n            if (splitAt === -1) break;\n            const block = buffer.slice(0, splitAt);\n            buffer = buffer.slice(splitAt + 2);\n            parseBlock(block, onEvent);\n        }\n        if (flush && buffer.trim()) {\n            parseBlock(buffer, onEvent);\n            buffer = '';\n        }\n    };\n}\n", "/**\n * Momnitrix QA Console \u2013 Audio Adapter\n *\n * Browser-only: uses AudioContext and MediaRecorder APIs.\n */\n\n/**\n * Encode an AudioBuffer into a WAV ArrayBuffer.\n */\nexport function encodeWavFromAudioBuffer(audioBuffer: AudioBuffer): ArrayBuffer {\n    const numChannels = audioBuffer.numberOfChannels;\n    const sampleRate = audioBuffer.sampleRate;\n    const samplesPerChannel = audioBuffer.length;\n    const bytesPerSample = 2;\n    const blockAlign = numChannels * bytesPerSample;\n    const dataSize = samplesPerChannel * blockAlign;\n    const buffer = new ArrayBuffer(44 + dataSize);\n    const view = new DataView(buffer);\n\n    function writeString(offset: number, text: string): void {\n        for (let i = 0; i < text.length; i += 1) {\n            view.setUint8(offset + i, text.charCodeAt(i));\n        }\n    }\n\n    writeString(0, 'RIFF');\n    view.setUint32(4, 36 + dataSize, true);\n    writeString(8, 'WAVE');\n    writeString(12, 'fmt ');\n    view.setUint32(16, 16, true);\n    view.setUint16(20, 1, true);\n    view.setUint16(22, numChannels, true);\n    view.setUint32(24, sampleRate, true);\n    view.setUint32(28, sampleRate * blockAlign, true);\n    view.setUint16(32, blockAlign, true);\n    view.setUint16(34, 16, true);\n    writeString(36, 'data');\n    view.setUint32(40, dataSize, true);\n\n    let offset = 44;\n    for (let i = 0; i < samplesPerChannel; i += 1) {\n        for (let channel = 0; channel < numChannels; channel += 1) {\n            const sample = audioBuffer.getChannelData(channel)[i];\n            const clamped = Math.max(-1, Math.min(1, sample));\n            const int16 = clamped < 0 ? clamped * 0x8000 : clamped * 0x7fff;\n            view.setInt16(offset, int16, true);\n            offset += 2;\n        }\n    }\n    return buffer;\n}\n\n/**\n * Try to convert a Blob to WAV format using the Web Audio API.\n * Returns null if conversion fails or AudioContext is unavailable.\n */\nexport async function convertToWavIfPossible(\n    blob: Blob,\n): Promise<Blob | null> {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const AudioCtor = (window as any).AudioContext || (window as any).webkitAudioContext;\n    if (!AudioCtor) return null;\n\n    try {\n        const audioContext = new AudioCtor() as AudioContext;\n        const arrayBuffer = await blob.arrayBuffer();\n        const audioBuffer = await audioContext.decodeAudioData(arrayBuffer.slice(0));\n        await audioContext.close();\n        const wavBuffer = encodeWavFromAudioBuffer(audioBuffer);\n        return new Blob([wavBuffer], { type: 'audio/wav' });\n    } catch {\n        return null;\n    }\n}\n", "/**\n * Momnitrix QA Console \u2013 Base64 Adapter\n *\n * Browser-only: uses FileReader API.\n */\n\n/**\n * Read a Blob as a base64-encoded string (without the data-URL prefix).\n */\nexport function base64FromBlob(blob: Blob): Promise<string> {\n    return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onload = () => {\n            const value = String(reader.result || '');\n            const split = value.split(',');\n            resolve(split.length > 1 ? split[1] : value);\n        };\n        reader.onerror = () =>\n            reject(new Error('Failed to read file for base64 conversion.'));\n        reader.readAsDataURL(blob);\n    });\n}\n", "/**\n * Momnitrix QA Console \u2013 Media Attachment Adapter\n *\n * Browser-only: reads File inputs for wound/skin images and audio.\n */\n\nimport type { TriageRequest } from '../domain/types';\nimport { base64FromBlob } from './base64';\nimport { convertToWavIfPossible } from './audio';\n\nexport interface MediaFiles {\n    woundImage: File | null;\n    skinImage: File | null;\n    uploadedAudio: File | null;\n    recordedAudioBlob: Blob | null;\n}\n\nexport interface AttachMediaResult {\n    audioStatusMessage: string | null;\n}\n\n/**\n * Attach media payloads (images, audio) to the triage request.\n *\n * Mutates `payload.inputs` in place for base64 fields.\n * Returns an optional status message for the audio path.\n */\nexport async function attachMedia(\n    payload: TriageRequest,\n    files: MediaFiles,\n): Promise<AttachMediaResult> {\n    let audioStatusMessage: string | null = null;\n\n    if (files.woundImage) {\n        payload.inputs.wound_image_b64 = await base64FromBlob(files.woundImage);\n    }\n\n    if (files.skinImage) {\n        payload.inputs.skin_image_b64 = await base64FromBlob(files.skinImage);\n    }\n\n    if (files.uploadedAudio) {\n        const wavBlob = await convertToWavIfPossible(files.uploadedAudio);\n        const blobToSend = wavBlob || files.uploadedAudio;\n        payload.inputs.audio_b64 = await base64FromBlob(blobToSend);\n        audioStatusMessage = wavBlob\n            ? 'Uploaded audio converted to WAV for MedASR'\n            : `Uploaded audio kept as ${files.uploadedAudio.type || 'original format'}`;\n        return { audioStatusMessage };\n    }\n\n    if (files.recordedAudioBlob) {\n        payload.inputs.audio_b64 = await base64FromBlob(files.recordedAudioBlob);\n    }\n\n    return { audioStatusMessage };\n}\n", "/**\n * Momnitrix QA Console \u2013 SSE Streaming Adapter\n *\n * Browser-only: reads a fetch Response body as a text stream and pipes\n * chunks into the SSE parser.\n */\n\n/**\n * Consume a streaming fetch response body and pipe decoded text chunks\n * to the given chunk handler.\n *\n * @param response \u2013 a fetch Response with a readable body\n * @param onChunk  \u2013 callback receiving `(text, flush)` for each decoded chunk\n */\nexport async function streamSseFromFetch(\n    response: Response,\n    onChunk: (text: string, flush: boolean) => void,\n): Promise<void> {\n    if (!response.body) {\n        throw new Error('Streaming response body is missing.');\n    }\n    const reader = response.body.getReader();\n    const decoder = new TextDecoder('utf-8');\n\n    while (true) {\n        const { value, done } = await reader.read();\n        if (done) break;\n        onChunk(decoder.decode(value, { stream: true }), false);\n    }\n    onChunk('', true);\n}\n", "/**\n * Momnitrix QA Console \u2013 Pure Formatters\n *\n * All functions are string \u2192 string (or value \u2192 string).  No DOM access.\n * Used for rendering final triage results, timeline entries, and parsed\n * model output sections.\n */\n\nimport type {\n    SectionedGuidance,\n    TriageFinalResponse,\n    SpecialistOutputs,\n    InferenceBreakdownEvent,\n} from './types';\nimport { EVENT_LABELS } from './constants';\n\n// ---------------------------------------------------------------------------\n// HTML escaping\n// ---------------------------------------------------------------------------\n\nexport function escapeHtml(value: string | null | undefined): string {\n    return String(value || '')\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;')\n        .replace(/'/g, '&#39;');\n}\n\n// ---------------------------------------------------------------------------\n// Section-based guidance parser\n// ---------------------------------------------------------------------------\n\nconst SECTION_KEY_MAP: Record<string, keyof SectionedGuidance> = {\n    'RISK LEVEL': 'risk_level',\n    'CLINICAL REASONING': 'clinical_reasoning',\n    'POTENTIAL COMPLICATIONS': 'potential_complications',\n    'RECOMMENDED ACTIONS': 'recommended_actions',\n    'WARNING SIGNS': 'warning_signs',\n};\n\nconst SECTION_HEADING_REGEX =\n    /^\\s*(RISK LEVEL|CLINICAL REASONING|POTENTIAL COMPLICATIONS|RECOMMENDED ACTIONS|WARNING SIGNS)\\s*:\\s*(.*)$/i;\n\n/**\n * Parse model-generated text into structured guidance sections.\n */\nexport function splitSectionedGuidance(rawText: string | null | undefined): SectionedGuidance {\n    const text = String(rawText || '').replace(/\\r/g, '');\n    const sections: SectionedGuidance = {\n        risk_level: '',\n        clinical_reasoning: [],\n        potential_complications: [],\n        recommended_actions: [],\n        warning_signs: [],\n    };\n\n    let currentKey: keyof SectionedGuidance | '' = '';\n\n    for (const line of text.split('\\n')) {\n        const match = line.match(SECTION_HEADING_REGEX);\n        if (match) {\n            const heading = match[1].toUpperCase();\n            currentKey = SECTION_KEY_MAP[heading] || '';\n            const tail = (match[2] || '').trim();\n            if (tail && currentKey) {\n                if (currentKey === 'risk_level') {\n                    sections.risk_level = tail;\n                } else {\n                    (sections[currentKey] as string[]).push(tail);\n                }\n            }\n            continue;\n        }\n\n        if (!currentKey) continue;\n        const cleaned = line.trim();\n        if (!cleaned) continue;\n        if (currentKey === 'risk_level') {\n            sections.risk_level = cleaned;\n        } else {\n            (sections[currentKey] as string[]).push(cleaned);\n        }\n    }\n\n    return sections;\n}\n\n// ---------------------------------------------------------------------------\n// List utilities\n// ---------------------------------------------------------------------------\n\n/**\n * Clean a list of raw lines: strip bullets, deduplicate, trim.\n */\nexport function toCleanList(lines: unknown): string[] {\n    const out: string[] = [];\n    const arr = Array.isArray(lines) ? (lines as unknown[]) : [];\n    for (const line of arr) {\n        const cleaned = String(line || '')\n            .replace(/^\\s*[-*\u2022]+\\s*/, '')\n            .replace(/\\s+/g, ' ')\n            .trim();\n        if (!cleaned) continue;\n        if (!out.includes(cleaned)) out.push(cleaned);\n    }\n    return out;\n}\n\n/**\n * Join cleaned list items into a paragraph.\n */\nexport function toParagraph(lines: unknown): string {\n    return toCleanList(lines).join(' ');\n}\n\n// ---------------------------------------------------------------------------\n// Image evidence\n// ---------------------------------------------------------------------------\n\n/**\n * Build human-readable evidence lines from specialist image outputs.\n */\nexport function buildImageEvidenceLines(specialist: SpecialistOutputs | null | undefined): string[] {\n    const lines: string[] = [];\n\n    if (specialist?.wound_scores) {\n        const wound = specialist.wound_scores;\n        const urgency = Number(wound.urgency || 0);\n        const infection = Number(wound.infection_risk || 0);\n        if (urgency >= 0.6 || infection >= 0.7) {\n            lines.push(\n                `Wound-image specialist flagged elevated risk (urgency ${urgency.toFixed(2)}, infection ${infection.toFixed(2)}).`,\n            );\n        } else {\n            lines.push(\n                `Wound-image specialist reviewed the image with no high-risk threshold crossed (urgency ${urgency.toFixed(2)}, infection ${infection.toFixed(2)}).`,\n            );\n        }\n    }\n\n    if (specialist?.skin_top3 && Array.isArray(specialist.skin_top3) && specialist.skin_top3.length) {\n        const labels = specialist.skin_top3\n            .slice(0, 3)\n            .map(\n                (row) =>\n                    `${String(row.condition || 'unknown').replace(/_/g, ' ')} (${Number(row.score || 0).toFixed(2)})`,\n            );\n        lines.push(`Skin specialist top findings: ${labels.join(', ')}.`);\n    }\n\n    return lines;\n}\n\n// ---------------------------------------------------------------------------\n// HTML renderers (return HTML strings, no DOM mutation)\n// ---------------------------------------------------------------------------\n\n/**\n * Render the patient guidance card HTML.\n */\nexport function formatPatientGuidanceHtml(finalPayload: TriageFinalResponse | null | undefined): string {\n    const fp = finalPayload || {};\n    const sectioned = splitSectionedGuidance(fp.patient_message);\n    const reasoning = toParagraph(sectioned.clinical_reasoning);\n    const complications = toParagraph(sectioned.potential_complications);\n    const actions = toCleanList(sectioned.recommended_actions);\n    const warnings = toCleanList(sectioned.warning_signs);\n    const specialist = fp.specialist_outputs || {};\n    const imageEvidenceLines = buildImageEvidenceLines(specialist);\n    const risk = String(fp.risk_level || sectioned.risk_level || '-')\n        .toUpperCase()\n        .replace('YELLOW', 'MID')\n        .replace('GREEN', 'LOW')\n        .replace('RED', 'HIGH');\n\n    const hasSections =\n        reasoning || complications || actions.length || warnings.length;\n    if (!hasSections) {\n        return `<p>${escapeHtml(fp.patient_message || 'No patient message generated.')}</p>`;\n    }\n\n    const riskClass =\n        risk === 'HIGH' ? 'red' : risk === 'MID' ? 'yellow' : 'green';\n    const actionsHtml = actions.length\n        ? `<ul class=\"guidance-list\">${actions.map((x) => `<li>${escapeHtml(x)}</li>`).join('')}</ul>`\n        : `<p class=\"guidance-empty\">No immediate actions listed.</p>`;\n    const warningsHtml = warnings.length\n        ? `<ul class=\"guidance-list\">${warnings.map((x) => `<li>${escapeHtml(x)}</li>`).join('')}</ul>`\n        : `<p class=\"guidance-empty\">No urgent warning signs listed.</p>`;\n\n    return `\n    <div class=\"patient-guidance\">\n      <div class=\"guidance-head\">\n        <span class=\"guidance-title\">For the patient</span>\n        <span class=\"risk-pill ${riskClass}\">${escapeHtml(risk)} RISK</span>\n      </div>\n      <div class=\"guidance-card\">\n        <h4>What this means now</h4>\n        <p>${escapeHtml(\n        reasoning ||\n        'Current readings do not show severe immediate danger, but continue close monitoring.',\n    )}</p>\n      </div>\n      <div class=\"guidance-card\">\n        <h4>Possible complications if this continues</h4>\n        <p>${escapeHtml(\n        complications ||\n        'Complication risk depends on future trends and symptom progression.',\n    )}</p>\n      </div>\n      ${imageEvidenceLines.length\n            ? `<div class=\"guidance-card\">\n              <h4>What image analysis found</h4>\n              <ul class=\"guidance-list\">${imageEvidenceLines.map((line) => `<li>${escapeHtml(line)}</li>`).join('')}</ul>\n            </div>`\n            : ''\n        }\n      <div class=\"guidance-card\">\n        <h4>What to do next</h4>\n        ${actionsHtml}\n      </div>\n      <div class=\"guidance-card warning\">\n        <h4>Seek urgent care now if</h4>\n        ${warningsHtml}\n      </div>\n    </div>\n  `;\n}\n\n/**\n * Render visit summary HTML.\n */\nexport function formatVisitSummaryHtml(summaryText: string | null | undefined): string {\n    const text = String(summaryText || '').trim();\n    if (!text) return 'No visit summary generated.';\n    const lines = text\n        .split('\\n')\n        .map((x) => x.trim())\n        .filter(Boolean);\n    const bullets = lines\n        .filter((line) => line.startsWith('-'))\n        .map((line) => line.replace(/^-+\\s*/, '').trim());\n    if (!bullets.length) {\n        return `<p>${escapeHtml(text)}</p>`;\n    }\n    return `<ul class=\"visit-list\">${bullets.map((line) => `<li>${escapeHtml(line)}</li>`).join('')}</ul>`;\n}\n\n/**\n * Render specialist summary HTML.\n */\nexport function formatSpecialistSummaryHtml(\n    specialist: SpecialistOutputs | null | undefined,\n): string {\n    const parts: string[] = [];\n\n    if (specialist?.transcript) {\n        const full = String(specialist.transcript).replace(/\\s+/g, ' ').trim();\n        const clipped = full.length > 170 ? `${full.slice(0, 170)}...` : full;\n        parts.push(`\n      <div class=\"specialist-chip\">\n        <strong>What the app heard:</strong> ${escapeHtml(clipped)}\n      </div>\n    `);\n    }\n\n    if (specialist?.wound_scores) {\n        const wound = specialist.wound_scores;\n        const urgency = Number(wound.urgency || 0);\n        const infection = Number(wound.infection_risk || 0);\n        const erythema = Number(wound.erythema || 0);\n        parts.push(\n            `<div class=\"specialist-chip\"><strong>Wound model:</strong> urgency ${urgency.toFixed(2)}, infection ${infection.toFixed(2)}, erythema ${erythema.toFixed(2)}.</div>`,\n        );\n    }\n\n    if (specialist?.skin_top3 || specialist?.skin_scores) {\n        if (\n            Array.isArray(specialist?.skin_top3) &&\n            specialist.skin_top3.length\n        ) {\n            const labels = specialist.skin_top3\n                .slice(0, 3)\n                .map(\n                    (row) =>\n                        `${String(row.condition || 'unknown').replace(/_/g, ' ')} (${Number(row.score || 0).toFixed(2)})`,\n                );\n            parts.push(\n                `<div class=\"specialist-chip\"><strong>Skin model:</strong> ${escapeHtml(labels.join(', '))}.</div>`,\n            );\n        } else {\n            parts.push(\n                '<div class=\"specialist-chip\">Skin specialist was used.</div>',\n            );\n        }\n    }\n\n    if (!parts.length) {\n        return 'No specialist outputs were used in this run.';\n    }\n    return `<div class=\"specialist-stack\">${parts.join('')}</div>`;\n}\n\n// ---------------------------------------------------------------------------\n// Timeline entry text\n// ---------------------------------------------------------------------------\n\n/**\n * Format a single SSE timeline entry as a display string.\n */\nexport function formatTimelineEntryText(\n    eventName: string,\n    payload: InferenceBreakdownEvent | Record<string, unknown> | null,\n): string {\n    const p = (payload || {}) as Record<string, unknown>;\n    const time =\n        typeof p.timestamp === 'string' ? p.timestamp : new Date().toISOString();\n    const label = EVENT_LABELS[eventName] || eventName;\n    const details: string[] = [];\n\n    if (p.model) details.push(`model=${p.model}`);\n    if (p.intent) details.push(`intent=${p.intent}`);\n    if (p.prompt_strategy) details.push(`strategy=${p.prompt_strategy}`);\n    if (p.risk_level) details.push(`risk=${p.risk_level}`);\n    if (p.latency_ms !== undefined) details.push(`latency=${p.latency_ms}ms`);\n    if (p.gpu_warmup_ms !== undefined) details.push(`warmup=${p.gpu_warmup_ms}ms`);\n    if (p.medgemma_inference_ms !== undefined) {\n        details.push(`medgemma_infer=${p.medgemma_inference_ms}ms`);\n    }\n    if (p.composer_mode) details.push(`composer=${p.composer_mode}`);\n    if (p.reason) details.push(`reason=${p.reason}`);\n    if (p.error) details.push(`error=${p.error}`);\n\n    return `${time} | ${label}${details.length ? ` | ${details.join(' | ')}` : ''}`;\n}\n\n// ---------------------------------------------------------------------------\n// JSON stringification\n// ---------------------------------------------------------------------------\n\nexport function stringifyJson(data: unknown): string {\n    return JSON.stringify(data, null, 2);\n}\n", "/**\n * Momnitrix QA Console \u2013 DOM / UI Orchestrator\n *\n * This is the ONLY module that touches `document` and `window`.\n * It reads form values, calls pure domain functions, and writes\n * results back to the DOM.\n */\n\nimport type {\n    FormValues,\n    Modality,\n    RunLog,\n    TriageFinalResponse,\n    TriageRequest,\n} from '../domain/types';\n\nimport {\n    REQUIRED_RULES,\n    OPTIONAL_NUMERIC_RULES,\n    DEFAULT_FORM_VALUES,\n    AUDIO_MIME_CANDIDATES,\n} from '../domain/constants';\n\nimport { evaluateRequiredInputs, validateAllInputs, parseNumericInput } from '../domain/validation';\nimport { composePayloadSkeleton } from '../domain/payload';\nimport { createSseEventParser } from '../domain/sse';\nimport { generateRandomProfile } from '../domain/randomizer';\nimport { convertToWavIfPossible } from '../adapters/audio';\nimport { attachMedia } from '../adapters/media';\nimport { streamSseFromFetch } from '../adapters/streaming';\nimport {\n    formatPatientGuidanceHtml,\n    formatVisitSummaryHtml,\n    formatSpecialistSummaryHtml,\n    formatTimelineEntryText,\n    stringifyJson,\n} from '../domain/formatters';\n\n// ---------------------------------------------------------------------------\n// DOM helpers\n// ---------------------------------------------------------------------------\n\nfunction el(id: string): HTMLElement {\n    return document.getElementById(id)!;\n}\n\nfunction inputEl(id: string): HTMLInputElement {\n    return document.getElementById(id) as HTMLInputElement;\n}\n\nfunction selectEl(id: string): HTMLSelectElement {\n    return document.getElementById(id) as HTMLSelectElement;\n}\n\nfunction textareaEl(id: string): HTMLTextAreaElement {\n    return document.getElementById(id) as HTMLTextAreaElement;\n}\n\n// ---------------------------------------------------------------------------\n// Application state\n// ---------------------------------------------------------------------------\n\ninterface AppState {\n    lastRun: RunLog | null;\n    activeRun: RunLog | null;\n    mediaRecorder: MediaRecorder | null;\n    mediaStream: MediaStream | null;\n    mediaChunks: Blob[];\n    recordedAudioBlob: Blob | null;\n    finalReceived: boolean;\n    activeMode: Modality;\n    resultCardIndex: number;\n    inferenceTimer: ReturnType<typeof setInterval> | null;\n    inferenceStartTime: number | null;\n}\n\nconst state: AppState = {\n    lastRun: null,\n    activeRun: null,\n    mediaRecorder: null,\n    mediaStream: null,\n    mediaChunks: [],\n    recordedAudioBlob: null,\n    finalReceived: false,\n    activeMode: 'text',\n    resultCardIndex: 0,\n    inferenceTimer: null,\n    inferenceStartTime: null,\n};\n\n// ---------------------------------------------------------------------------\n// Form value extraction (DOM \u2192 pure types)\n// ---------------------------------------------------------------------------\n\nfunction getNumericValue(id: string): number | null {\n    return parseNumericInput(inputEl(id).value);\n}\n\nfunction extractRequiredValues(): Record<string, number | null> {\n    const values: Record<string, number | null> = {};\n    for (const rule of REQUIRED_RULES) {\n        values[rule.id] = getNumericValue(rule.id);\n    }\n    return values;\n}\n\nfunction extractOptionalValues(): Record<string, string> {\n    const values: Record<string, string> = {};\n    for (const rule of OPTIONAL_NUMERIC_RULES) {\n        values[rule.id] = inputEl(rule.id).value;\n    }\n    return values;\n}\n\nfunction extractFormValues(): FormValues {\n    return {\n        age: getNumericValue('age'),\n        gestWeeks: getNumericValue('gestWeeks'),\n        gravidity: getNumericValue('gravidity'),\n        parity: getNumericValue('parity'),\n        bmiGroup: selectEl('bmiGroup').value,\n        knownConditions: inputEl('knownConditions').value,\n        medications: inputEl('medications').value,\n        systolicBp: getNumericValue('systolicBp'),\n        diastolicBp: getNumericValue('diastolicBp'),\n        fastingGlucose: getNumericValue('fastingGlucose'),\n        tempF: getNumericValue('tempF'),\n        restingHr: getNumericValue('restingHr'),\n        spo2: getNumericValue('spo2'),\n        hrv: getNumericValue('hrv'),\n        headache: inputEl('headache').checked,\n        visionChanges: inputEl('visionChanges').checked,\n        decreasedFetalMovement: inputEl('decreasedFetalMovement').checked,\n        freeText: textareaEl('freeText').value,\n        requestId: inputEl('requestId').value,\n        backendUrl: inputEl('backendUrl').value,\n    };\n}\n\n// ---------------------------------------------------------------------------\n// Status / validation display\n// ---------------------------------------------------------------------------\n\nfunction updateStatus(message: string): void {\n    el('statusLine').textContent = message;\n}\n\nfunction updateValidation(message: string): void {\n    el('validationLine').textContent = message || '';\n}\n\nfunction setHealthLine(message: string, kind = ''): void {\n    const node = el('healthLine');\n    node.textContent = message;\n    node.className = kind ? `health-line ${kind}` : 'health-line';\n}\n\n// ---------------------------------------------------------------------------\n// Image preview\n// ---------------------------------------------------------------------------\n\nfunction setPreview(fileInput: HTMLInputElement, previewEl: HTMLImageElement): void {\n    const file = fileInput.files?.[0];\n    if (!file) {\n        previewEl.style.display = 'none';\n        previewEl.removeAttribute('src');\n        return;\n    }\n    const objectUrl = URL.createObjectURL(file);\n    previewEl.src = objectUrl;\n    previewEl.style.display = 'block';\n}\n\n// ---------------------------------------------------------------------------\n// Required-field gate\n// ---------------------------------------------------------------------------\n\nexport function updateRequiredGate(): void {\n    const requiredValues = extractRequiredValues();\n    const { missing, errors } = evaluateRequiredInputs(requiredValues);\n\n    const requiredHint = el('requiredHint');\n    const badge = el('requiredBadge');\n    const vitalsChip = el('openVitalsBtn');\n    const needsInput = missing.length > 0 || errors.length > 0;\n\n    badge.textContent = String(missing.length);\n\n    if (missing.length > 0) {\n        requiredHint.textContent = `Missing required inputs: ${missing.join(', ')}.`;\n        requiredHint.className = 'required-hint';\n        vitalsChip.classList.remove('ok');\n    } else if (errors.length > 0) {\n        requiredHint.textContent = errors[0];\n        requiredHint.className = 'required-hint';\n        vitalsChip.classList.remove('ok');\n    } else {\n        requiredHint.textContent = 'All required vitals are present.';\n        requiredHint.className = 'required-hint ok';\n    }\n\n    if (needsInput) {\n        vitalsChip.classList.remove('ok');\n        vitalsChip.classList.add('needs-input');\n    } else {\n        vitalsChip.classList.remove('needs-input');\n        vitalsChip.classList.add('ok');\n    }\n\n    if (!state.activeRun) {\n        (el('submitBtn') as HTMLButtonElement).disabled =\n            missing.length > 0 || errors.length > 0;\n    }\n}\n\n// ---------------------------------------------------------------------------\n// Mode switching\n// ---------------------------------------------------------------------------\n\nfunction setActiveMode(mode: Modality): void {\n    state.activeMode = mode;\n\n    // 1. Highlight the button on the home screen\n    const modeBtnIds = {\n        text: 'modeTextBtn',\n        voice: 'modeVoiceBtn',\n        image: 'modeImageBtn',\n    };\n    Object.entries(modeBtnIds).forEach(([m, id]) => {\n        el(id).classList.toggle('active', m === mode);\n    });\n\n    // 2. Toggle the panel inside the sheet\n    const panels: Array<{ id: string; mode: Modality }> = [\n        { id: 'textPanel', mode: 'text' },\n        { id: 'voicePanel', mode: 'voice' },\n        { id: 'imagePanel', mode: 'image' },\n    ];\n\n    for (const item of panels) {\n        const node = el(item.id);\n        if (node) {\n            node.classList.toggle('active', item.mode === mode);\n        }\n    }\n    updateModeIndicators();\n}\n\n/**\n * Update the indicators (e.g. green dots) on the home screen cards\n * to show which modes currently have pending data (note, audio, or images).\n */\nexport function updateModeIndicators(): void {\n    const hasNote = textareaEl('freeText').value.trim().length > 0;\n    const hasAudio =\n        inputEl('audioFile').files?.length || state.recordedAudioBlob;\n    const hasImage =\n        inputEl('woundImage').files?.length || inputEl('skinImage').files?.length;\n\n    el('modeTextBtn').classList.toggle('has-data', hasNote);\n    el('modeVoiceBtn').classList.toggle('has-data', !!hasAudio);\n    el('modeImageBtn').classList.toggle('has-data', !!hasImage);\n\n    // Also update Diagnose sub-label to show mode context\n    const modeLabel = state.activeMode.charAt(0).toUpperCase() + state.activeMode.slice(1);\n    const subLabel = el('submitBtn').querySelector('small');\n    if (subLabel) {\n        subLabel.textContent = `Run AI Triage (${modeLabel})`;\n    }\n}\n\n// ---------------------------------------------------------------------------\n// Inference loading indicator\n// ---------------------------------------------------------------------------\n\nfunction showInferenceLoader(): void {\n    const loader = document.getElementById('inferenceLoader');\n    if (!loader) return;\n    loader.hidden = false;\n    // Hide all result cards while loading\n    const cards = Array.from(document.querySelectorAll('.result-card')) as HTMLElement[];\n    for (const card of cards) card.style.display = 'none';\n    const nav = document.querySelector('.carousel-bottom-nav') as HTMLElement | null;\n    if (nav) nav.style.display = 'none';\n    const pipelineSection = document.querySelector('#resultsWrapper > .panel') as HTMLElement | null;\n    if (pipelineSection) pipelineSection.style.display = 'none';\n\n    // Start elapsed timer\n    state.inferenceStartTime = Date.now();\n    const elapsedEl = document.getElementById('loaderElapsed');\n    if (elapsedEl) elapsedEl.textContent = 'Elapsed: 0s';\n    if (state.inferenceTimer) clearInterval(state.inferenceTimer);\n    state.inferenceTimer = setInterval(() => {\n        if (!state.inferenceStartTime) return;\n        const secs = Math.floor((Date.now() - state.inferenceStartTime) / 1000);\n        const mins = Math.floor(secs / 60);\n        const remainSecs = secs % 60;\n        if (elapsedEl) {\n            elapsedEl.textContent = mins > 0\n                ? `Elapsed: ${mins}m ${remainSecs}s`\n                : `Elapsed: ${secs}s`;\n        }\n    }, 1000);\n}\n\nfunction hideInferenceLoader(): void {\n    const loader = document.getElementById('inferenceLoader');\n    if (loader) loader.hidden = true;\n    // Restore result cards visibility\n    const cards = Array.from(document.querySelectorAll('.result-card')) as HTMLElement[];\n    for (const card of cards) card.style.display = '';\n    const nav = document.querySelector('.carousel-bottom-nav') as HTMLElement | null;\n    if (nav) nav.style.display = '';\n    const pipelineSection = document.querySelector('#resultsWrapper > .panel') as HTMLElement | null;\n    if (pipelineSection) pipelineSection.style.display = '';\n\n    // Stop elapsed timer\n    if (state.inferenceTimer) {\n        clearInterval(state.inferenceTimer);\n        state.inferenceTimer = null;\n    }\n    state.inferenceStartTime = null;\n}\n\n// ---------------------------------------------------------------------------\n// Result carousel\n// ---------------------------------------------------------------------------\n\nfunction listResultCards(): HTMLElement[] {\n    return Array.from(document.querySelectorAll('.result-card')) as HTMLElement[];\n}\n\nexport function showResultCard(index: number): void {\n    const cards = listResultCards();\n    if (!cards.length) return;\n    const safeIndex = Math.max(0, Math.min(index, cards.length - 1));\n    state.resultCardIndex = safeIndex;\n\n    for (let i = 0; i < cards.length; i += 1) {\n        cards[i].classList.toggle('is-active', i === safeIndex);\n    }\n\n    const prev = el('prevCardBtn') as HTMLButtonElement | null;\n    const next = el('nextCardBtn') as HTMLButtonElement | null;\n    if (prev) prev.disabled = safeIndex <= 0;\n    if (next) next.disabled = safeIndex >= cards.length - 1;\n    el('cardPosition').textContent = `${safeIndex + 1} / ${cards.length}`;\n}\n\nfunction shiftResultCard(delta: number): void {\n    showResultCard(state.resultCardIndex + delta);\n    const wrapper = el('resultsWrapper');\n    if (wrapper) wrapper.scrollTop = 0;\n}\n\n// ---------------------------------------------------------------------------\n// List rendering\n// ---------------------------------------------------------------------------\n\nfunction renderList(id: string, values: unknown, emptyText: string): void {\n    const node = el(id);\n    node.innerHTML = '';\n    const items = Array.isArray(values) ? (values as unknown[]) : [];\n    if (!items.length) {\n        const li = document.createElement('li');\n        li.textContent = emptyText;\n        node.appendChild(li);\n        return;\n    }\n    for (const item of items) {\n        const li = document.createElement('li');\n        li.textContent = String(item);\n        node.appendChild(li);\n    }\n}\n\n// ---------------------------------------------------------------------------\n// Run view reset\n// ---------------------------------------------------------------------------\n\nfunction resetRunViews(): void {\n    el('eventTimeline').innerHTML = '';\n    textareaEl('finalJson').value = '';\n    el('riskLevel').textContent = '-';\n    const riskEl = document.getElementById('riskLevel');\n    if (riskEl) riskEl.className = 'risk-pill-hero';\n    const pf = document.getElementById('policyFloor');\n    if (pf) pf.textContent = '-';\n    const dc = document.getElementById('diagComposer');\n    if (dc) dc.textContent = '-';\n    const dms = document.getElementById('diagModelShare');\n    if (dms) dms.textContent = '-';\n    const dcs = document.getElementById('diagColdStart');\n    if (dcs) dcs.textContent = '-';\n    const dwm = document.getElementById('diagWarmupMs');\n    if (dwm) dwm.textContent = '-';\n    const dmm = document.getElementById('diagMedgemmaMs');\n    if (dmm) dmm.textContent = '-';\n    el('diagTotalMs').textContent = '-';\n    el('patientMessage').innerHTML = 'No result yet.';\n    el('visitSummary').innerHTML = 'No result yet.';\n    el('specialistSummary').innerHTML = 'No specialist outputs yet.';\n    renderList('reasonsList', [], 'No reasons yet.');\n    renderList('actionsList', [], 'No action plan yet.');\n    showResultCard(0);\n}\n\n// ---------------------------------------------------------------------------\n// Diagnostics\n// ---------------------------------------------------------------------------\n\nfunction setDiagnosticsFromBreakdown(payload: Record<string, unknown>): void {\n    const modelShare =\n        typeof payload.model === 'string' ? payload.model : '-';\n    const dms = document.getElementById('diagModelShare');\n    if (dms) dms.textContent = modelShare;\n    const dc = document.getElementById('diagComposer');\n    if (dc)\n        dc.textContent =\n            typeof payload.composer_mode === 'string'\n                ? payload.composer_mode\n                : '-';\n    if (payload.gpu_warmup_ms !== undefined) {\n        const dwm = document.getElementById('diagWarmupMs');\n        if (dwm) dwm.textContent = String(payload.gpu_warmup_ms);\n    }\n    if (payload.medgemma_inference_ms !== undefined) {\n        const dmm = document.getElementById('diagMedgemmaMs');\n        if (dmm) dmm.textContent = String(payload.medgemma_inference_ms);\n    }\n    if (payload.latency_ms !== undefined) {\n        const dtm = document.getElementById('diagTotalMs');\n        if (dtm) dtm.textContent = String(payload.latency_ms);\n    }\n}\n\nfunction setDiagnosticsFromFinal(finalPayload: TriageFinalResponse): void {\n    const diag = finalPayload.inference_diagnostics || {};\n    const timing = diag.medgemma_timing_breakdown || {};\n    const share = diag.latency_share_pct || {};\n    const total = finalPayload.latency_ms?.total;\n\n    const dc = document.getElementById('diagComposer');\n    if (dc)\n        dc.textContent = diag.composer_mode || dc.textContent || '-';\n\n    if (share.medgemma !== undefined || share.gemini !== undefined) {\n        const m =\n            share.medgemma !== undefined\n                ? Number(share.medgemma).toFixed(1)\n                : '0.0';\n        const g =\n            share.gemini !== undefined ? Number(share.gemini).toFixed(1) : '0.0';\n        const dms = document.getElementById('diagModelShare');\n        if (dms) dms.textContent = `medgemma:${m}% | gemini:${g}%`;\n    }\n    if (timing.cold_start !== undefined) {\n        const dcs = document.getElementById('diagColdStart');\n        if (dcs) dcs.textContent = timing.cold_start ? 'YES' : 'NO';\n    }\n    if (timing.gpu_warmup_ms !== undefined) {\n        const dwm = document.getElementById('diagWarmupMs');\n        if (dwm) dwm.textContent = String(timing.gpu_warmup_ms);\n    }\n    if (timing.medgemma_inference_ms !== undefined) {\n        const dmm = document.getElementById('diagMedgemmaMs');\n        if (dmm) dmm.textContent = String(timing.medgemma_inference_ms);\n    }\n    if (total !== undefined) {\n        const dtm = document.getElementById('diagTotalMs');\n        if (dtm) dtm.textContent = String(total);\n    }\n}\n\n// ---------------------------------------------------------------------------\n// Final response rendering\n// ---------------------------------------------------------------------------\n\nfunction setFinalResponse(finalPayload: TriageFinalResponse): void {\n    const riskLevel = String(finalPayload.risk_level || '-').toLowerCase();\n    const riskEl = el('riskLevel');\n    riskEl.textContent = riskLevel.toUpperCase();\n    riskEl.className = 'risk-pill-hero ' + riskLevel;\n    el('policyFloor').textContent = String(\n        finalPayload.policy_floor || '-',\n    ).toUpperCase();\n    setDiagnosticsFromFinal(finalPayload);\n    el('patientMessage').innerHTML = formatPatientGuidanceHtml(finalPayload);\n    el('visitSummary').innerHTML = formatVisitSummaryHtml(\n        finalPayload.visit_prep_summary,\n    );\n    const specialist = finalPayload.specialist_outputs || {};\n    el('specialistSummary').innerHTML = formatSpecialistSummaryHtml(specialist);\n    renderList(\n        'reasonsList',\n        finalPayload.medgemma_reasons,\n        'No clinical reasons returned.',\n    );\n    renderList('actionsList', finalPayload.action_items, 'No actions returned.');\n    textareaEl('finalJson').value = stringifyJson(finalPayload);\n    showResultCard(0);\n}\n\n// ---------------------------------------------------------------------------\n// Timeline\n// ---------------------------------------------------------------------------\n\nfunction timelineEntry(\n    eventName: string,\n    payload: Record<string, unknown>,\n): void {\n    const li = document.createElement('li');\n    li.textContent = formatTimelineEntryText(eventName, payload);\n    el('eventTimeline').appendChild(li);\n    li.scrollIntoView({ block: 'nearest' });\n}\n\n// ---------------------------------------------------------------------------\n// Run log\n// ---------------------------------------------------------------------------\n\nfunction buildRunLog(url: string, payload: TriageRequest): void {\n    state.activeRun = {\n        backend_url: url,\n        started_at: new Date().toISOString(),\n        completed_at: null,\n        duration_ms: null,\n        request_payload: payload,\n        events: [],\n        final_response: null,\n    };\n    state.lastRun = null;\n    state.finalReceived = false;\n    (el('downloadLogBtn') as HTMLButtonElement).disabled = true;\n}\n\nfunction completeRunLog(): void {\n    if (!state.activeRun) return;\n    state.activeRun.completed_at = new Date().toISOString();\n    const start = Date.parse(state.activeRun.started_at);\n    const end = Date.parse(state.activeRun.completed_at);\n    state.activeRun.duration_ms =\n        Number.isNaN(start) || Number.isNaN(end) ? null : end - start;\n    state.lastRun = state.activeRun;\n    state.activeRun = null;\n    (el('downloadLogBtn') as HTMLButtonElement).disabled = false;\n}\n\n// ---------------------------------------------------------------------------\n// Backend health check\n// ---------------------------------------------------------------------------\n\nasync function checkBackendHealth(): Promise<void> {\n    updateValidation('');\n    const baseUrl = inputEl('backendUrl')\n        .value.trim()\n        .replace(/\\/$/, '');\n    if (!baseUrl.startsWith('http://') && !baseUrl.startsWith('https://')) {\n        setHealthLine('Invalid backend URL.', 'err');\n        return;\n    }\n\n    setHealthLine('Checking backend health...', '');\n    try {\n        const response = await fetch(`${baseUrl}/health?probe=1`);\n        if (!response.ok) throw new Error(`HTTP ${response.status}`);\n        const data = (await response.json()) as Record<string, unknown>;\n        const core = data.core_gpu_reachable === true ? 'core:up' : 'core:down';\n        const derm = data.derm_reachable === true ? 'derm:up' : 'derm:down';\n        const asr = data.medasr_reachable === true ? 'medasr:up' : 'medasr:down';\n        const composerDefault =\n            (data.default_response_composer_mode as string) ||\n            (data.response_composer_mode as string) ||\n            'unknown';\n        setHealthLine(\n            `Healthy | ${core} | ${derm} | ${asr} | default_mode=${composerDefault} (request can override)`,\n            'ok',\n        );\n    } catch (err: unknown) {\n        const msg = err instanceof Error ? err.message : String(err);\n        setHealthLine(`Health check failed: ${msg}`, 'err');\n    }\n}\n\n// ---------------------------------------------------------------------------\n// Submit / stream\n// ---------------------------------------------------------------------------\n\nasync function submitRequest(): Promise<void> {\n    updateValidation('');\n    const formValues = extractFormValues();\n    const requiredValues = extractRequiredValues();\n    const optionalValues = extractOptionalValues();\n\n    const uploadedAudio = inputEl('audioFile').files?.[0] ?? null;\n    const hasAudio = Boolean(uploadedAudio || state.recordedAudioBlob);\n\n    const validationErrors = validateAllInputs(\n        requiredValues,\n        optionalValues,\n        formValues.backendUrl.trim(),\n        state.activeMode,\n        hasAudio,\n    );\n\n    if (validationErrors.length) {\n        updateValidation(validationErrors.join(' '));\n        updateRequiredGate();\n        openInputValuesPanel();\n        return;\n    }\n\n    const payload: TriageRequest = composePayloadSkeleton(\n        formValues,\n        state.activeMode,\n    );\n\n    const mediaResult = await attachMedia(payload, {\n        woundImage: inputEl('woundImage').files?.[0] ?? null,\n        skinImage: inputEl('skinImage').files?.[0] ?? null,\n        uploadedAudio,\n        recordedAudioBlob: state.recordedAudioBlob,\n    });\n\n    if (mediaResult.audioStatusMessage) {\n        el('recordStatus').textContent = mediaResult.audioStatusMessage;\n    }\n\n    if (state.activeMode === 'voice' && !payload.inputs.audio_b64) {\n        updateValidation(\n            'Voice mode selected but no audio payload could be attached.',\n        );\n        return;\n    }\n\n    const baseUrl = formValues.backendUrl.trim().replace(/\\/$/, '');\n    const endpoint = `${baseUrl}/v1/triage/stream`;\n    buildRunLog(baseUrl, payload);\n    resetRunViews();\n    updateStatus('Submitting request and opening SSE stream...');\n\n    const submitBtn = el('submitBtn') as HTMLButtonElement;\n    submitBtn.disabled = true;\n    openResultsPanel();\n    showInferenceLoader();\n\n    try {\n        const response = await fetch(endpoint, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(payload),\n        });\n\n        if (!response.ok) {\n            const text = await response.text();\n            throw new Error(`HTTP ${response.status}: ${text}`);\n        }\n\n        const parser = createSseEventParser(\n            (eventName: string, eventPayload: Record<string, unknown>) => {\n                if (state.activeRun) {\n                    state.activeRun.events.push({\n                        event: eventName,\n                        payload: eventPayload,\n                    });\n                }\n                timelineEntry(eventName, eventPayload);\n\n                if (eventName === 'diagnostics.inference_breakdown') {\n                    setDiagnosticsFromBreakdown(eventPayload);\n                }\n                if (eventName === 'triage.final') {\n                    state.finalReceived = true;\n                    hideInferenceLoader();\n                    if (state.activeRun)\n                        state.activeRun.final_response =\n                            eventPayload as unknown as TriageFinalResponse;\n                    setFinalResponse(eventPayload as unknown as TriageFinalResponse);\n                }\n                if (eventName === 'triage.error') {\n                    const msg =\n                        typeof eventPayload.error === 'string'\n                            ? eventPayload.error\n                            : 'Unknown triage error';\n                    updateValidation(`Triage error: ${msg}`);\n                }\n            },\n        );\n\n        await streamSseFromFetch(response, parser);\n        completeRunLog();\n\n        if (state.finalReceived) {\n            updateStatus('Stream complete. Final triage received.');\n        } else {\n            updateStatus(\n                'Stream complete, but no triage.final event was found.',\n            );\n        }\n    } catch (err: unknown) {\n        hideInferenceLoader();\n        completeRunLog();\n        updateStatus('Request failed.');\n        const msg = err instanceof Error ? err.message : String(err);\n        updateValidation(msg);\n    } finally {\n        updateRequiredGate();\n    }\n}\n\n// ---------------------------------------------------------------------------\n// Reset\n// ---------------------------------------------------------------------------\n\nexport function resetToDefaults(): void {\n    inputEl('requestId').value = DEFAULT_FORM_VALUES.requestId;\n    inputEl('randomProfileMode').value = DEFAULT_FORM_VALUES.randomProfileMode;\n    inputEl('age').value = DEFAULT_FORM_VALUES.age;\n    inputEl('gestWeeks').value = DEFAULT_FORM_VALUES.gestWeeks;\n    inputEl('gravidity').value = DEFAULT_FORM_VALUES.gravidity;\n    inputEl('parity').value = DEFAULT_FORM_VALUES.parity;\n    selectEl('bmiGroup').value = DEFAULT_FORM_VALUES.bmiGroup;\n    inputEl('knownConditions').value = DEFAULT_FORM_VALUES.knownConditions;\n    inputEl('medications').value = DEFAULT_FORM_VALUES.medications;\n\n    inputEl('systolicBp').value = DEFAULT_FORM_VALUES.systolicBp;\n    inputEl('diastolicBp').value = DEFAULT_FORM_VALUES.diastolicBp;\n    inputEl('fastingGlucose').value = DEFAULT_FORM_VALUES.fastingGlucose;\n    inputEl('tempF').value = DEFAULT_FORM_VALUES.tempF;\n    inputEl('restingHr').value = DEFAULT_FORM_VALUES.restingHr;\n    inputEl('spo2').value = DEFAULT_FORM_VALUES.spo2;\n    inputEl('hrv').value = DEFAULT_FORM_VALUES.hrv;\n\n    inputEl('headache').checked = DEFAULT_FORM_VALUES.headache;\n    inputEl('visionChanges').checked = DEFAULT_FORM_VALUES.visionChanges;\n    inputEl('decreasedFetalMovement').checked =\n        DEFAULT_FORM_VALUES.decreasedFetalMovement;\n    textareaEl('freeText').value = DEFAULT_FORM_VALUES.freeText;\n\n    inputEl('woundImage').value = '';\n    inputEl('skinImage').value = '';\n    inputEl('audioFile').value = '';\n    setPreview(\n        inputEl('woundImage'),\n        document.getElementById('woundPreview') as HTMLImageElement,\n    );\n    setPreview(\n        inputEl('skinImage'),\n        document.getElementById('skinPreview') as HTMLImageElement,\n    );\n\n    state.recordedAudioBlob = null;\n    el('recordStatus').textContent = 'Not recording';\n    setHealthLine('Not checked.');\n    updateValidation('');\n    updateStatus('Ready.');\n    resetRunViews();\n    state.lastRun = null;\n    state.activeRun = null;\n    (el('downloadLogBtn') as HTMLButtonElement).disabled = true;\n    setActiveMode('text');\n    updateRequiredGate();\n    updateModeIndicators();\n    closeResultsPanel();\n}\n\n// ---------------------------------------------------------------------------\n// Audio status\n// ---------------------------------------------------------------------------\n\nfunction updateAudioStatus(): void {\n    const uploadedAudio = inputEl('audioFile').files?.[0];\n    if (uploadedAudio) {\n        el('recordStatus').textContent = `Audio file selected: ${uploadedAudio.name}`;\n        return;\n    }\n    if (state.recordedAudioBlob) {\n        el('recordStatus').textContent = 'Recorded (stored for MedASR)';\n        return;\n    }\n    el('recordStatus').textContent = 'Not recording';\n}\n\n// ---------------------------------------------------------------------------\n// Randomizer\n// ---------------------------------------------------------------------------\n\nfunction fillFromRandomProfile(): void {\n    const profile = generateRandomProfile();\n\n    inputEl('age').value = String(profile.age);\n    inputEl('gestWeeks').value = String(profile.gestWeeks);\n    inputEl('gravidity').value = String(profile.gravidity);\n    inputEl('parity').value = String(profile.parity);\n    selectEl('bmiGroup').value = profile.bmiGroup;\n    inputEl('systolicBp').value = String(profile.systolicBp);\n    inputEl('diastolicBp').value = String(profile.diastolicBp);\n    inputEl('fastingGlucose').value = String(profile.fastingGlucose);\n    inputEl('tempF').value = String(profile.tempF);\n    inputEl('restingHr').value = String(profile.restingHr);\n    inputEl('spo2').value = String(profile.spo2);\n    inputEl('hrv').value = String(profile.hrv);\n    inputEl('headache').checked = profile.headache;\n    inputEl('visionChanges').checked = profile.visionChanges;\n    inputEl('decreasedFetalMovement').checked = profile.decreasedFetalMovement;\n    inputEl('knownConditions').value = profile.knownConditions;\n    inputEl('medications').value = profile.medications;\n    textareaEl('freeText').value = profile.freeText;\n    inputEl('randomProfileMode').value = profile.profileModeName;\n\n    updateStatus(`Randomized using profile mode: ${profile.profileModeName}`);\n    updateValidation('');\n    updateRequiredGate();\n    updateModeIndicators();\n}\n\n// ---------------------------------------------------------------------------\n// Recording\n// ---------------------------------------------------------------------------\n\nasync function startRecording(): Promise<void> {\n    if (!navigator.mediaDevices?.getUserMedia) {\n        updateValidation('Browser microphone access is not available.');\n        return;\n    }\n    try {\n        state.mediaStream = await navigator.mediaDevices.getUserMedia({\n            audio: true,\n        });\n        const mimeType =\n            AUDIO_MIME_CANDIDATES.find((m) =>\n                MediaRecorder.isTypeSupported(m),\n            ) || '';\n        state.mediaChunks = [];\n        state.mediaRecorder = mimeType\n            ? new MediaRecorder(state.mediaStream, { mimeType })\n            : new MediaRecorder(state.mediaStream);\n\n        state.mediaRecorder.ondataavailable = (event: BlobEvent) => {\n            if (event.data?.size > 0) {\n                state.mediaChunks.push(event.data);\n            }\n        };\n\n        state.mediaRecorder.onstop = async () => {\n            const blobType = mimeType || 'audio/webm';\n            const rawBlob = new Blob(state.mediaChunks, { type: blobType });\n            const wavBlob = await convertToWavIfPossible(rawBlob);\n            state.recordedAudioBlob = wavBlob || rawBlob;\n\n            if (state.mediaStream) {\n                state.mediaStream.getTracks().forEach((track) => track.stop());\n            }\n\n            state.mediaStream = null;\n            state.mediaRecorder = null;\n            state.mediaChunks = [];\n            (el('recordStart') as HTMLButtonElement).disabled = false;\n            (el('recordStop') as HTMLButtonElement).disabled = true;\n            el('recordStatus').textContent = wavBlob\n                ? 'Recorded (stored as WAV for MedASR)'\n                : 'Recorded (original codec)';\n            updateModeIndicators();\n        };\n\n        state.mediaRecorder.start();\n        state.recordedAudioBlob = null;\n        updateModeIndicators();\n        (el('recordStart') as HTMLButtonElement).disabled = true;\n        (el('recordStop') as HTMLButtonElement).disabled = false;\n        el('recordStatus').textContent = 'Recording...';\n        updateStatus('Microphone recording started.');\n    } catch (err: unknown) {\n        const msg = err instanceof Error ? err.message : String(err);\n        updateValidation(`Microphone error: ${msg}`);\n    }\n}\n\nfunction stopRecording(): void {\n    if (!state.mediaRecorder) return;\n    state.mediaRecorder.stop();\n    updateStatus('Recording stopped, processing audio...');\n}\n\n// ---------------------------------------------------------------------------\n// Download run log\n// ---------------------------------------------------------------------------\n\nfunction downloadRunLog(): void {\n    if (!state.lastRun) return;\n    const fileName = `momnitrix-run-${Date.now()}.json`;\n    const blob = new Blob([stringifyJson(state.lastRun)], {\n        type: 'application/json',\n    });\n    const url = URL.createObjectURL(blob);\n    const anchor = document.createElement('a');\n    anchor.href = url;\n    anchor.download = fileName;\n    document.body.appendChild(anchor);\n    anchor.click();\n    anchor.remove();\n    URL.revokeObjectURL(url);\n}\n\n// ---------------------------------------------------------------------------\n// Panels / sheets\n// ---------------------------------------------------------------------------\n\nfunction openInputValuesPanel(): void {\n    const panel = el('inputValuesPanel');\n    const backdrop = el('inputValuesBackdrop');\n    if (!panel || !backdrop) return;\n    panel.hidden = false;\n    panel.classList.add('is-open');\n    backdrop.hidden = false;\n    backdrop.classList.add('is-open');\n    el('openVitalsBtn').setAttribute('aria-expanded', 'true');\n    document.body.classList.add('sheet-open');\n    const firstField = document.getElementById('age');\n    if (firstField) firstField.focus();\n}\n\nfunction openInteractionPanel(): void {\n    const panel = document.getElementById('interactionSheet');\n    const backdrop = el('inputValuesBackdrop');\n    if (!panel || !backdrop) return;\n    panel.hidden = false;\n    backdrop.hidden = false;\n    document.body.classList.add('sheet-open');\n    // Force reflow for CSS transition\n    void panel.offsetWidth;\n    panel.classList.add('is-open');\n    backdrop.classList.add('is-open');\n}\n\nfunction closeInteractionPanel(): void {\n    const panel = document.getElementById('interactionSheet');\n    const backdrop = el('inputValuesBackdrop');\n    if (!panel || !backdrop) return;\n    panel.classList.remove('is-open');\n    backdrop.classList.remove('is-open');\n    document.body.classList.remove('sheet-open');\n    setTimeout(() => {\n        if (!panel.classList.contains('is-open')) {\n            panel.hidden = true;\n            backdrop.hidden = true;\n        }\n    }, 250);\n}\n\nfunction closeInputValuesPanel(): void {\n    const panel = el('inputValuesPanel');\n    const backdrop = el('inputValuesBackdrop');\n    if (!panel || !backdrop) return;\n    panel.classList.remove('is-open');\n    backdrop.classList.remove('is-open');\n    document.body.classList.remove('sheet-open');\n    el('openVitalsBtn').setAttribute('aria-expanded', 'false');\n    el('openVitalsBtn').focus();\n    setTimeout(() => {\n        if (!panel.classList.contains('is-open')) {\n            panel.hidden = true;\n            backdrop.hidden = true;\n        }\n    }, 250);\n}\n\nfunction openResultsPanel(): void {\n    const panel = el('resultsWrapper');\n    const backdrop = el('inputValuesBackdrop');\n    if (!panel || !backdrop) return;\n    panel.hidden = false;\n    backdrop.hidden = false;\n    document.body.classList.add('sheet-open');\n    // Force reflow for CSS transition\n    void panel.offsetWidth;\n    panel.classList.add('is-open');\n    backdrop.classList.add('is-open');\n}\n\nfunction closeResultsPanel(): void {\n    const panel = el('resultsWrapper');\n    const backdrop = el('inputValuesBackdrop');\n    if (!panel || !backdrop) return;\n    panel.classList.remove('is-open');\n    backdrop.classList.remove('is-open');\n    document.body.classList.remove('sheet-open');\n    setTimeout(() => {\n        if (!panel.classList.contains('is-open')) {\n            panel.hidden = true;\n            backdrop.hidden = true;\n        }\n    }, 250);\n}\n\n// ---------------------------------------------------------------------------\n// Watch import placeholder\n// ---------------------------------------------------------------------------\n\nfunction importWatchPlaceholder(): void {\n    updateStatus(\n        'Watch import placeholder is active. Manual values remain enabled for prototype testing.',\n    );\n}\n\n// ---------------------------------------------------------------------------\n// Event wiring\n// ---------------------------------------------------------------------------\n\nexport function wireEvents(): void {\n    el('modeTextBtn').addEventListener('click', () => {\n        setActiveMode('text');\n        openInteractionPanel();\n    });\n    el('modeVoiceBtn').addEventListener('click', () => {\n        setActiveMode('voice');\n        openInteractionPanel();\n    });\n    el('modeImageBtn').addEventListener('click', () => {\n        setActiveMode('image');\n        openInteractionPanel();\n    });\n\n    el('openVitalsBtn').addEventListener('click', openInputValuesPanel);\n    el('closeVitalsBtn').addEventListener('click', closeInputValuesPanel);\n\n    const closeResultsBtn = document.getElementById('closeResultsBtn');\n    if (closeResultsBtn) {\n        closeResultsBtn.addEventListener('click', closeResultsPanel);\n    }\n    const closeInteractionBtn = document.getElementById('closeInteractionBtn');\n    if (closeInteractionBtn) {\n        closeInteractionBtn.addEventListener('click', closeInteractionPanel);\n    }\n\n    el('inputValuesBackdrop').addEventListener('click', () => {\n        closeInputValuesPanel();\n        closeResultsPanel();\n        closeInteractionPanel();\n    });\n\n    el('prevCardBtn').addEventListener('click', () => shiftResultCard(-1));\n    el('nextCardBtn').addEventListener('click', () => shiftResultCard(1));\n    el('importWatchBtn').addEventListener('click', importWatchPlaceholder);\n\n    inputEl('woundImage').addEventListener('change', () => {\n        setPreview(\n            inputEl('woundImage'),\n            document.getElementById('woundPreview') as HTMLImageElement,\n        );\n        updateModeIndicators();\n    });\n    inputEl('skinImage').addEventListener('change', () => {\n        setPreview(\n            inputEl('skinImage'),\n            document.getElementById('skinPreview') as HTMLImageElement,\n        );\n        updateModeIndicators();\n    });\n    el('randomizeBtn').addEventListener('click', fillFromRandomProfile);\n    el('submitBtn').addEventListener('click', () => void submitRequest());\n    el('clearBtn').addEventListener('click', resetToDefaults);\n    el('downloadLogBtn').addEventListener('click', downloadRunLog);\n    el('recordStart').addEventListener('click', () => void startRecording());\n    el('recordStop').addEventListener('click', stopRecording);\n    el('checkHealthBtn').addEventListener('click', () =>\n        void checkBackendHealth(),\n    );\n    inputEl('audioFile').addEventListener('change', () => {\n        if (inputEl('audioFile').files?.[0]) {\n            state.recordedAudioBlob = null;\n        }\n        updateAudioStatus();\n        updateModeIndicators();\n    });\n\n    el('clearTextBtn').addEventListener('click', () => {\n        textareaEl('freeText').value = '';\n        updateModeIndicators();\n    });\n\n    el('clearVoiceBtn').addEventListener('click', () => {\n        inputEl('audioFile').value = '';\n        state.recordedAudioBlob = null;\n        updateAudioStatus();\n        updateModeIndicators();\n    });\n\n    el('clearImageBtn').addEventListener('click', () => {\n        inputEl('woundImage').value = '';\n        inputEl('skinImage').value = '';\n        setPreview(inputEl('woundImage'), el('woundPreview') as HTMLImageElement);\n        setPreview(inputEl('skinImage'), el('skinPreview') as HTMLImageElement);\n        updateModeIndicators();\n    });\n\n    el('freeText').addEventListener('input', updateModeIndicators);\n\n    const watchedFields = [\n        ...REQUIRED_RULES.map((x) => x.id),\n        ...OPTIONAL_NUMERIC_RULES.map((x) => x.id),\n        'backendUrl',\n    ];\n    for (const id of watchedFields) {\n        el(id).addEventListener('input', updateRequiredGate);\n    }\n\n    // Final check for indicators on boot\n    updateModeIndicators();\n    setActiveMode('text');\n\n    document.addEventListener('keydown', (event: KeyboardEvent) => {\n        const inputPanel = document.getElementById('inputValuesPanel');\n        const resultsPanel = document.getElementById('resultsWrapper');\n        const interactionPanel = document.getElementById('interactionSheet');\n        if (event.key !== 'Escape') return;\n        if (inputPanel && !inputPanel.hidden) closeInputValuesPanel();\n        if (resultsPanel && !resultsPanel.hidden) closeResultsPanel();\n        if (interactionPanel && !interactionPanel.hidden) closeInteractionPanel();\n    });\n}\n", "/**\n * Momnitrix QA Console \u2013 Entry Point\n *\n * Boots the app by wiring DOM events and setting initial state.\n * This file is the esbuild entry: it bundles into `app.js`.\n */\n\nimport { wireEvents, showResultCard, resetToDefaults } from './ui/dom';\n\nwireEvents();\nshowResultCard(0);\nresetToDefaults();\n"],
  "mappings": "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",
  "names": ["pick", "offset"]
}
